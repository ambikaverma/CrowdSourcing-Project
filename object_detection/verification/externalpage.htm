<!-- This file needs to be hosted on an external server.  -->
<html>

<link rel='stylesheet' type='text/css' href='css/style.css'>
<link rel='stylesheet' type='text/css' href='css/rangeSlider.css'>
<link rel='stylesheet' type='text/css' href='css/modal.css'>

<script src='https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js'></script>
<script src='js/turkey-lite/js/turkey-lite.js'></script>
<script language='Javascript'>
// This method Gets URL Parameters (GUP)
function gup(name) {
  var regexS = "[\\?&]" + name + "=([^&#]*)";
  var regex = new RegExp(regexS);
  var tmpURL = window.location.href;
  var results = regex.exec(tmpURL);
  if (results == null)
    return "";
  else
    return results[1];
}

// This method decodes the query parameters that were URL-encoded
function decode(strToDecode) {
  var encoded = strToDecode;
  return unescape(encoded.replace(/\+/g,  ' '));
}
</script>

<body>
<form id='mturk_form' method='POST' action='https://www.mturk.com/mturk/externalSubmit'>

<input type='hidden' id='assignmentId' name='assignmentId' value=''>

<div id='instructions'>

<p><b class='important'>Instructions:</b> A smart computer is trying to detect what objects are in an image and needs your help! Your job is to verify if its bounding box and corresponding cateogry label are accurate.
<ul>
  <li>You will be shown 10 images one by one. Each image will have a detected object consisting of a bounding box (orange box) and category label (red text). Answer the following questions:</li>
  <ul>
    <li>Does the bounding box surround or partially contain an object (such as a person or a car)? Select <i>Yes</i> or <i>No</i>.</li>
    <li>Is the category label consistent with the object in the bounding box? Select <i>Yes</i> or <i>No</i>. If you selected <i>No</i> for the previous question, you should select <i>No</i> for this question as well.</li>
  </ul>
  <li>Rate your confidence using the slider. Values range from 1 (<i>Not at all</i>) to 5 (<i>Completely</i>).</li>
  <li>Press the <b>< Prev</b> and <b>Next ></b> buttons to navigate between images. If the image does not load, click the red button. Once you have reached the last image, press <b>Next ></b> to optionally provide feedback and submit your work.</li>
</ul>
</p>

</div>

<div>

<div id='task' class='section'>

<table id='grid'>
  <td id='left'>
    <canvas></canvas>
  </td>
  <td id='right'>
    <div>
      <b>1. Does the bounding box surround or partially contain an object (such as a person or a car)?</b><br><br>
      <table id='verifyBox'>
        <tr>
          <td><input type='radio' name='verifybox' value='yes'>&nbsp;Yes&nbsp;&nbsp;
          <input type='radio' name='verifybox' value='no'>&nbsp;No</td>
        </tr>
      </table>
    </div><br>
    <div>
      <b>2. The predicted category is <span class='important' id='category'></span>. Is this consistent with the object in the bounding box?</b><br><br>
      <table id='verifyLabel'>
        <tr>
          <tr>
          <td><input type='radio' name='verifylabel' value='yes'>&nbsp;Yes&nbsp;&nbsp;
          <input type='radio' name='verifylabel' value='no'>&nbsp;No</td>
        </tr>
        </tr>
      </table>
    </div><br>
    <div>
      <b>3. How confident are you in your answer?</b>
      <table>
        <tr><td><input id='confidenceRange' type='range' name='confidence' min='1' max='5'></td></tr>
        <tr><td><p id='confidenceLabel'></p></td></tr>
      </table>
    </div><br>
    <div>
      <table id='navButtons'>
        <tr>
          <td><button type='button' id='prev' class='nav'>< Prev</button></td>
          <td><button type='button' id='issue' class='nav'>Image did<br>not load</button></td>
          <td><button type='button' id='next' class='nav'>Next ></button></td>
          <td><span id='counter'></span>&nbsp;/ <span id='total'></span></td>
        </tr>
      </table>
    </div>
  </td>
</table>
</div>

<div id='feedback' class='modal'>

<div class="modal-content">
  <h3>Feedback</h3>
  <table>
    <tr><td>Thank you for taking the time to complete this task. If you would like to provide us feedback regarding this HIT, please do so here. To submit your answers, please click the <b>Submit</b> button. To return to the task, press the <b>Go back</b> button.</td></tr>

    <tr><td><textarea name='feedback'></textarea></td></tr>
    <tr>
      <td><input id='submitButton' type='submit' name='Submit' value='Submit'>
      <button id="submit-cancel" type='button'>Go back</button></td>
    </tr>
  </table>
</div>

</div>

</div>

</form>

<script src='js/pre-labels.js'></script>
<script src='js/rangeSlider.js'></script>
<script src='js/canvas.js'></script>
<script src='js/main.js'></script>
<script src='js/nav.js'></script>

<script language='Javascript'>
$("#assignmentId").val(gup("assignmentId"));
// Check if the worker is PREVIEWING the HIT or if they"ve ACCEPTED the HIT
if (gup("assignmentId") == "ASSIGNMENT_ID_NOT_AVAILABLE") {
  // If we"re previewing, disable the button and give it a helpful message
  $("#submitButton").attr("disabled", true)
  $("*").click(function(evt) {
    evt.stopPropagation();
    alert("Please accept the HIT before working on it.");
  });
} else {
  if (document.referrer && (document.referrer.indexOf("workersandbox") != -1))
    $("#mturk_form").attr("action", "https://workersandbox.mturk.com/mturk/externalSubmit");
}
</script>

</body>
</html>
